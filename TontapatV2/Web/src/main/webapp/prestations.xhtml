<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:b="http://bootsfaces.net/ui"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

<!-- To talk to Marc about header -->	
<h:head>
	<ui:insert name="head"></ui:insert>
</h:head>

<ui:composition template="/arch.xhtml">

	<ui:define name="head">
		<title>Mes Prestations</title>
		<!-- <f:metadata>
			<f:event listener="#{mbAccount.disconnect()}" type="preRenderView"></f:event>
		</f:metadata> -->
	</ui:define>
	
	<ui:define name="content">
		<div class="terrainsTitre">
			<h1>Vos Prestations, <h:outputText value="#{mbCompte.utilisateur.nom}" /> !</h1>
		</div>		

		<b:tabView activeIndex="2">
		  <b:tab title="En Cours">
		    <div class="terrainsDivs">
			<ui:repeat class="terrainsBigDiv" var="prestaBU" value="#{mbPresta.prestations}">
				<h:panelGroup rendered="#{prestaBU.value.stateString == 'CONFIRMEPARELEVEUR' || prestaBU.value.stateString == 'RESERVEPARCLIENT' || prestaBU.value.stateString == 'RESERVEPARELEVEUR'}">
						
				</h:panelGroup>
			</ui:repeat>
			
		</div>
	  </b:tab>
	  <b:tab title="En Attentes">
	  <f:facet name="anchor"><b:iconAwesome name="cog" spin="true" /></f:facet>
	    <div class="terrainsDivs">
			<ui:repeat class="terrainsBigDiv" var="prestaBU" value="#{mbPresta.prestations}">
			<h:panelGroup rendered="#{prestaBU.value.stateString == 'CONFIRMEPARELEVEUR' || prestaBU.value.stateString == 'RESERVEPARCLIENT' || prestaBU.value.stateString == 'RESERVEPARELEVEUR'}">
				
			
			</h:panelGroup>
			</ui:repeat>
		</div>
	  </b:tab>
	  <!-- The next tab shows tabs aren't limited to text. You can put anything in a tab. -->
	  <b:tab title="Terminées">
		<div class="terrainsDivs">
			<c:forEach var="prestaBU" items="#{mbPresta.prestations}" >
				<div class="terrainsBigDiv">
					<div class="terrainSmallDiv">
						<ui:include src="#{prestaBU.value.templateXhtml}">
							<ui:param name="prestaBuByMain" value="#{prestaBU.value}" />
							<ui:param name="user" value="#{mbCompte}" />
							<!-- no need to pass #mbPresta (include ?) -->
						</ui:include>
					</div>
				</div>
			</c:forEach>
		</div>
	  </b:tab>
	  <b:tab title="Annulées">
	    <p>This is fancy tab with a spinning image.</p>
	  </b:tab>
		 
		</b:tabView>
		
		<!--  test State, out of loop ui:repeat it is ok, inside problem : maybe more to come-->
	<!-- https://stackoverflow.com/questions/3362487/dynamic-uiinclude-inside-uirepeat-is-there-a-simple-solution -->
			Test : <h:outputLabel value="#{mbPresta.prestations[0].templateXhtml}"/>
<!-- 	<ui:repeat var="prestaBU" value="#{mbPresta.prestations}" > -->
		<div class="terrainsDivs">
			<c:forEach var="prestaBU" items="#{mbPresta.prestations}" >
			<div class="terrainsBigDiv">
				<div class="terrainSmallDiv">
					<ui:include src="#{prestaBU.value.templateXhtml}">
						<ui:param name="prestaBuByMain" value="#{prestaBU.value}" />
						<ui:param name="user" value="#{mbCompte}" />
						<!-- no need to pass #mbPresta (include ?) -->
					</ui:include>
				</div>
			</div>
			</c:forEach>
		</div>
		
</ui:define>
</ui:composition>
</html>